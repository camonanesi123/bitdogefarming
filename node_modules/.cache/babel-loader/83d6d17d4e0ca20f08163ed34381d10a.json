{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"D:/task159/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/task159/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/task159/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"D:/task159/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  padding-top: 16px;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useMemo,useState,useCallback}from'react';import styled from'styled-components';import{getContract}from'utils/erc20';import{Button,Flex,Text}from'@pancakeswap-libs/uikit';import{useFarm3FromPid,useFarm3User}from'state/hooks';import useI18n from'hooks/useI18n';import UnlockButton from'components/UnlockButton';import{useApprove3}from'hooks/useApprove';import StakeAction from'./StakeAction';import HarvestAction from'./HarvestAction';var Action=styled.div(_templateObject());var CardActions=function CardActions(_ref){var farm=_ref.farm,ethereum=_ref.ethereum,account=_ref.account;var TranslateString=useI18n();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),requestedApproval=_useState2[0],setRequestedApproval=_useState2[1];var _useFarm3FromPid=useFarm3FromPid(farm.pid),pid=_useFarm3FromPid.pid,lpAddresses=_useFarm3FromPid.lpAddresses,tokenAddresses=_useFarm3FromPid.tokenAddresses,isTokenOnly=_useFarm3FromPid.isTokenOnly,depositFeeBP=_useFarm3FromPid.depositFeeBP;var _useFarm3User=useFarm3User(pid),allowance=_useFarm3User.allowance,tokenBalance=_useFarm3User.tokenBalance,stakedBalance=_useFarm3User.stakedBalance,earnings=_useFarm3User.earnings;var lpAddress=lpAddresses[process.env.REACT_APP_CHAIN_ID];var tokenAddress=tokenAddresses[process.env.REACT_APP_CHAIN_ID];var lpName=farm.lpSymbol.toUpperCase();var isApproved=account&&allowance&&allowance.isGreaterThan(0);var lpContract=useMemo(function(){if(isTokenOnly){return getContract(ethereum,tokenAddress);}return getContract(ethereum,lpAddress);},[ethereum,lpAddress,tokenAddress,isTokenOnly]);var _useApprove=useApprove3(lpContract),onApprove=_useApprove.onApprove;var handleApprove=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setRequestedApproval(true);_context.next=4;return onApprove();case 4:setRequestedApproval(false);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);})),[onApprove]);var renderApprovalOrStakeButton=function renderApprovalOrStakeButton(){return isApproved?/*#__PURE__*/_jsx(StakeAction,{stakedBalance:stakedBalance,tokenBalance:tokenBalance,tokenName:lpName,pid:pid,depositFeeBP:depositFeeBP}):/*#__PURE__*/_jsx(Button,{mt:\"8px\",width:\"100%\",disabled:requestedApproval,onClick:handleApprove,children:TranslateString(999,'Approve Contract')});};return/*#__PURE__*/_jsxs(Action,{children:[/*#__PURE__*/_jsxs(Flex,{children:[/*#__PURE__*/_jsx(Text,{bold:true,textTransform:\"uppercase\",color:\"secondary\",fontSize:\"12px\",pr:\"3px\",children:\"SENZU\"}),/*#__PURE__*/_jsx(Text,{bold:true,textTransform:\"uppercase\",color:\"textSubtle\",fontSize:\"12px\",children:TranslateString(999,'Earned')})]}),/*#__PURE__*/_jsx(HarvestAction,{earnings:earnings,pid:pid}),/*#__PURE__*/_jsxs(Flex,{children:[/*#__PURE__*/_jsx(Text,{bold:true,textTransform:\"uppercase\",color:\"secondary\",fontSize:\"12px\",pr:\"3px\",children:lpName}),/*#__PURE__*/_jsx(Text,{bold:true,textTransform:\"uppercase\",color:\"textSubtle\",fontSize:\"12px\",children:TranslateString(999,'Staked')})]}),!account?/*#__PURE__*/_jsx(UnlockButton,{mt:\"8px\",fullWidth:true}):renderApprovalOrStakeButton()]});};export default CardActions;","map":{"version":3,"sources":["D:/task159/frontend/src/views/Layer/Farms/components/FarmCard/CardActionsContainer.tsx"],"names":["React","useMemo","useState","useCallback","styled","getContract","Button","Flex","Text","useFarm3FromPid","useFarm3User","useI18n","UnlockButton","useApprove3","StakeAction","HarvestAction","Action","div","CardActions","farm","ethereum","account","TranslateString","requestedApproval","setRequestedApproval","pid","lpAddresses","tokenAddresses","isTokenOnly","depositFeeBP","allowance","tokenBalance","stakedBalance","earnings","lpAddress","process","env","REACT_APP_CHAIN_ID","tokenAddress","lpName","lpSymbol","toUpperCase","isApproved","isGreaterThan","lpContract","onApprove","handleApprove","console","error","renderApprovalOrStakeButton"],"mappings":"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","sourcesContent":["import React, { useMemo, useState, useCallback } from 'react'\nimport BigNumber from 'bignumber.js'\nimport styled from 'styled-components'\nimport { provider } from 'web3-core'\nimport { getContract } from 'utils/erc20'\nimport { Button, Flex, Text } from '@pancakeswap-libs/uikit'\nimport { Farm3 } from 'state/types'\nimport { useFarm3FromPid, useFarm3FromSymbol, useFarm3User } from 'state/hooks'\nimport useI18n from 'hooks/useI18n'\nimport UnlockButton from 'components/UnlockButton'\nimport { useApprove3 } from 'hooks/useApprove'\nimport StakeAction from './StakeAction'\nimport HarvestAction from './HarvestAction'\n\nconst Action = styled.div`\n  padding-top: 16px;\n`\nexport interface FarmWithStakedValue extends Farm3 {\n  apy?: BigNumber\n}\n\ninterface FarmCardActionsProps {\n  farm: FarmWithStakedValue\n  ethereum?: provider\n  account?: string\n}\n\nconst CardActions: React.FC<FarmCardActionsProps> = ({ farm, ethereum, account }) => {\n  const TranslateString = useI18n()\n  const [requestedApproval, setRequestedApproval] = useState(false)\n  const { pid, lpAddresses, tokenAddresses, isTokenOnly, depositFeeBP } = useFarm3FromPid(farm.pid)\n  const { allowance, tokenBalance, stakedBalance, earnings } = useFarm3User(pid)\n  const lpAddress = lpAddresses[process.env.REACT_APP_CHAIN_ID]\n  const tokenAddress = tokenAddresses[process.env.REACT_APP_CHAIN_ID];\n  const lpName = farm.lpSymbol.toUpperCase()\n  const isApproved = account && allowance && allowance.isGreaterThan(0)\n\n  const lpContract = useMemo(() => {\n    if(isTokenOnly){\n      return getContract(ethereum as provider, tokenAddress);\n    }\n    return getContract(ethereum as provider, lpAddress);\n  }, [ethereum, lpAddress, tokenAddress, isTokenOnly])\n\n  const { onApprove } = useApprove3(lpContract)\n\n  const handleApprove = useCallback(async () => {\n    try {\n      setRequestedApproval(true)\n      await onApprove()\n      setRequestedApproval(false)\n    } catch (e) {\n      console.error(e)\n    }\n  }, [onApprove])\n\n  const renderApprovalOrStakeButton = () => {\n    return isApproved ? (\n      <StakeAction stakedBalance={stakedBalance} tokenBalance={tokenBalance} tokenName={lpName} pid={pid} depositFeeBP={depositFeeBP} />\n    ) : (\n      <Button mt=\"8px\" width=\"100%\" disabled={requestedApproval} onClick={handleApprove}>\n        {TranslateString(999, 'Approve Contract')}\n      </Button>\n    )\n  }\n\n  return (\n    <Action>\n      <Flex>\n        <Text bold textTransform=\"uppercase\" color=\"secondary\" fontSize=\"12px\" pr=\"3px\">\n          SENZU\n        </Text>\n        <Text bold textTransform=\"uppercase\" color=\"textSubtle\" fontSize=\"12px\">\n          {TranslateString(999, 'Earned')}\n        </Text>\n      </Flex>\n      <HarvestAction earnings={earnings} pid={pid} />\n      <Flex>\n        <Text bold textTransform=\"uppercase\" color=\"secondary\" fontSize=\"12px\" pr=\"3px\">\n          {lpName}\n        </Text>\n        <Text bold textTransform=\"uppercase\" color=\"textSubtle\" fontSize=\"12px\">\n          {TranslateString(999, 'Staked')}\n        </Text>\n      </Flex>\n      {!account ? <UnlockButton mt=\"8px\" fullWidth /> : renderApprovalOrStakeButton()}\n    </Action>\n  )\n}\n\nexport default CardActions\n"]},"metadata":{},"sourceType":"module"}