{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"D:/task159/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/task159/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/task159/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"D:/task159/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  height: 64px;\\n  width: 64px;\\n\\n  \",\" {\\n    height: 128px;\\n    width: 128px;\\n  }\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  border-color: \",\";\\n  color: \",\";\\n  margin-bottom: 24px;\\n\\n  &:hover:not(:disabled):not(.button--disabled):not(:active) {\\n    border-color: \",\";\\n    opacity: 0.8;\\n  }\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useEffect,useState}from'react';import styled from'styled-components';import BigNumber from'bignumber.js';import{Button,Flex,Text}from'@pancakeswap-libs/uikit';import{getFullDisplayBalance}from'utils/formatBalance';import{getPancakeProfileAddress}from'utils/addressHelpers';import{useCake}from'hooks/useContract';import useI18n from'hooks/useI18n';import useGetProfileCosts from'hooks/useGetProfileCosts';import useHasCakeBalance from'hooks/useHasCakeBalance';import{useProfile}from'state/hooks';import{useWallet}from'@binance-chain/bsc-use-wallet';import ProfileAvatar from'../ProfileAvatar';var DangerOutline=styled(Button).attrs({variant:'secondary'})(_templateObject(),function(_ref){var theme=_ref.theme;return theme.colors.failure;},function(_ref2){var theme=_ref2.theme;return theme.colors.failure;},function(_ref3){var theme=_ref3.theme;return theme.colors.failure;});var AvatarWrapper=styled.div(_templateObject2(),function(_ref4){var theme=_ref4.theme;return theme.mediaQueries.sm;});var StartPage=function StartPage(_ref5){var goToApprove=_ref5.goToApprove,goToChange=_ref5.goToChange,goToRemove=_ref5.goToRemove,onDismiss=_ref5.onDismiss;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),needsApproval=_useState2[0],setNeedsApproval=_useState2[1];var _useProfile=useProfile(),profile=_useProfile.profile;var _useGetProfileCosts=useGetProfileCosts(),numberCakeToUpdate=_useGetProfileCosts.numberCakeToUpdate,numberCakeToReactivate=_useGetProfileCosts.numberCakeToReactivate;var minimumCakeRequired=profile.isActive?numberCakeToUpdate:numberCakeToReactivate;var hasMinimumCakeRequired=useHasCakeBalance(minimumCakeRequired);var TranslateString=useI18n();var _useWallet=useWallet(),account=_useWallet.account;var cakeContract=useCake();var cost=profile.isActive?numberCakeToUpdate:numberCakeToReactivate;/**\n   * Check if the wallet has the required CAKE allowance to change their profile pic or reactivate\n   * If they don't, we send them to the approval screen first\n   */useEffect(function(){var checkApprovalStatus=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,currentAllowance;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return cakeContract.methods.allowance(account,getPancakeProfileAddress()).call();case 2:response=_context.sent;currentAllowance=new BigNumber(response);setNeedsApproval(currentAllowance.lt(cost));case 5:case\"end\":return _context.stop();}}},_callee);}));return function checkApprovalStatus(){return _ref6.apply(this,arguments);};}();if(account){checkApprovalStatus();}},[account,cost,setNeedsApproval,cakeContract]);if(!profile){return null;}return/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",justifyContent:\"center\",flexDirection:\"column\",children:[/*#__PURE__*/_jsx(AvatarWrapper,{children:/*#__PURE__*/_jsx(ProfileAvatar,{profile:profile})}),/*#__PURE__*/_jsx(Flex,{alignItems:\"center\",style:{height:'48px'},justifyContent:\"center\",children:/*#__PURE__*/_jsx(Text,{as:\"p\",color:\"failure\",children:!hasMinimumCakeRequired&&TranslateString(999,\"\".concat(getFullDisplayBalance(minimumCakeRequired),\" CAKE required to change profile pic\"))})}),profile.isActive?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{width:\"100%\",mb:\"8px\",onClick:needsApproval===true?goToApprove:goToChange,disabled:!hasMinimumCakeRequired||needsApproval===null,children:TranslateString(999,'Change Profile Pic')}),/*#__PURE__*/_jsx(DangerOutline,{width:\"100%\",onClick:goToRemove,children:TranslateString(999,'Remove Profile Pic')})]}):/*#__PURE__*/_jsx(Button,{width:\"100%\",mb:\"8px\",onClick:needsApproval===true?goToApprove:goToChange,disabled:!hasMinimumCakeRequired||needsApproval===null,children:TranslateString(999,'Reactivate Profile')}),/*#__PURE__*/_jsx(Button,{variant:\"text\",width:\"100%\",onClick:onDismiss,children:TranslateString(999,'Close Window')})]});};export default StartPage;","map":{"version":3,"sources":["D:/task159/frontend/src/views/Profile/components/EditProfileModal/StartView.tsx"],"names":["React","useEffect","useState","styled","BigNumber","Button","Flex","Text","getFullDisplayBalance","getPancakeProfileAddress","useCake","useI18n","useGetProfileCosts","useHasCakeBalance","useProfile","useWallet","ProfileAvatar","DangerOutline","attrs","variant","theme","colors","failure","AvatarWrapper","div","mediaQueries","sm","StartPage","goToApprove","goToChange","goToRemove","onDismiss","needsApproval","setNeedsApproval","profile","numberCakeToUpdate","numberCakeToReactivate","minimumCakeRequired","isActive","hasMinimumCakeRequired","TranslateString","account","cakeContract","cost","checkApprovalStatus","methods","allowance","call","response","currentAllowance","lt","height"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport styled from 'styled-components'\nimport BigNumber from 'bignumber.js'\nimport { useWeb3React } from '@web3-react/core'\nimport { Button, Flex, Text, InjectedModalProps } from '@pancakeswap-libs/uikit'\nimport { getFullDisplayBalance } from 'utils/formatBalance'\nimport { getPancakeProfileAddress } from 'utils/addressHelpers'\nimport { useCake } from 'hooks/useContract'\nimport useI18n from 'hooks/useI18n'\nimport useGetProfileCosts from 'hooks/useGetProfileCosts'\nimport useHasCakeBalance from 'hooks/useHasCakeBalance'\nimport { useProfile } from 'state/hooks'\nimport { useWallet } from '@binance-chain/bsc-use-wallet'\nimport { UseEditProfileResponse } from './reducer'\nimport ProfileAvatar from '../ProfileAvatar'\n\ninterface StartPageProps extends InjectedModalProps {\n  goToChange: UseEditProfileResponse['goToChange']\n  goToRemove: UseEditProfileResponse['goToRemove']\n  goToApprove: UseEditProfileResponse['goToApprove']\n}\n\nconst DangerOutline = styled(Button).attrs({ variant: 'secondary' })`\n  border-color: ${({ theme }) => theme.colors.failure};\n  color: ${({ theme }) => theme.colors.failure};\n  margin-bottom: 24px;\n\n  &:hover:not(:disabled):not(.button--disabled):not(:active) {\n    border-color: ${({ theme }) => theme.colors.failure};\n    opacity: 0.8;\n  }\n`\n\nconst AvatarWrapper = styled.div`\n  height: 64px;\n  width: 64px;\n\n  ${({ theme }) => theme.mediaQueries.sm} {\n    height: 128px;\n    width: 128px;\n  }\n`\n\nconst StartPage: React.FC<StartPageProps> = ({ goToApprove, goToChange, goToRemove, onDismiss }) => {\n  const [needsApproval, setNeedsApproval] = useState(null)\n  const { profile } = useProfile()\n  const { numberCakeToUpdate, numberCakeToReactivate } = useGetProfileCosts()\n  const minimumCakeRequired = profile.isActive ? numberCakeToUpdate : numberCakeToReactivate\n  const hasMinimumCakeRequired = useHasCakeBalance(minimumCakeRequired)\n  const TranslateString = useI18n()\n  const { account } = useWallet()\n  const cakeContract = useCake()\n  const cost = profile.isActive ? numberCakeToUpdate : numberCakeToReactivate\n\n  /**\n   * Check if the wallet has the required CAKE allowance to change their profile pic or reactivate\n   * If they don't, we send them to the approval screen first\n   */\n  useEffect(() => {\n    const checkApprovalStatus = async () => {\n      const response = await cakeContract.methods.allowance(account, getPancakeProfileAddress()).call()\n      const currentAllowance = new BigNumber(response)\n      setNeedsApproval(currentAllowance.lt(cost))\n    }\n\n    if (account) {\n      checkApprovalStatus()\n    }\n  }, [account, cost, setNeedsApproval, cakeContract])\n\n  if (!profile) {\n    return null\n  }\n\n  return (\n    <Flex alignItems=\"center\" justifyContent=\"center\" flexDirection=\"column\">\n      <AvatarWrapper>\n        <ProfileAvatar profile={profile} />\n      </AvatarWrapper>\n      <Flex alignItems=\"center\" style={{ height: '48px' }} justifyContent=\"center\">\n        <Text as=\"p\" color=\"failure\">\n          {!hasMinimumCakeRequired &&\n            TranslateString(999, `${getFullDisplayBalance(minimumCakeRequired)} CAKE required to change profile pic`)}\n        </Text>\n      </Flex>\n      {profile.isActive ? (\n        <>\n          <Button\n            width=\"100%\"\n            mb=\"8px\"\n            onClick={needsApproval === true ? goToApprove : goToChange}\n            disabled={!hasMinimumCakeRequired || needsApproval === null}\n          >\n            {TranslateString(999, 'Change Profile Pic')}\n          </Button>\n          <DangerOutline width=\"100%\" onClick={goToRemove}>\n            {TranslateString(999, 'Remove Profile Pic')}\n          </DangerOutline>\n        </>\n      ) : (\n        <Button\n          width=\"100%\"\n          mb=\"8px\"\n          onClick={needsApproval === true ? goToApprove : goToChange}\n          disabled={!hasMinimumCakeRequired || needsApproval === null}\n        >\n          {TranslateString(999, 'Reactivate Profile')}\n        </Button>\n      )}\n      <Button variant=\"text\" width=\"100%\" onClick={onDismiss}>\n        {TranslateString(999, 'Close Window')}\n      </Button>\n    </Flex>\n  )\n}\n\nexport default StartPage\n"]},"metadata":{},"sourceType":"module"}