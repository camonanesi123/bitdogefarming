{"ast":null,"code":"import _taggedTemplateLiteral from\"D:/task159/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"D:/task159/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"D:/task159/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  align-items: center;\\n  color: \",\";\\n  display: grid;\\n  grid-gap: 32px;\\n  grid-template-columns: 1fr;\\n  margin-left: auto;\\n  margin-right: auto;\\n  max-width: 250px;\\n  ul {\\n    margin: 0;\\n    padding: 0;\\n    list-style-type: none;\\n    font-size: 16px;\\n    li {\\n      margin-bottom: 4px;\\n    }\\n  }\\n  img {\\n    height: auto;\\n    max-width: 100%;\\n  }\\n  @media (min-width: 576px) {\\n    grid-template-columns: 1fr 1fr;\\n    margin: 0;\\n    max-width: none;\\n  }\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React from'react';import{Route,useRouteMatch}from'react-router-dom';import BigNumber from'bignumber.js';import styled from'styled-components';import{useWallet}from'@binance-chain/bsc-use-wallet';import{Heading}from'@pancakeswap-libs/uikit';import{BLOCKS_PER_YEAR}from'config';import orderBy from'lodash/orderBy';import partition from'lodash/partition';import useI18n from'hooks/useI18n';import useBlock from'hooks/useBlock';import{getBalanceNumber}from'utils/formatBalance';import{useFarms,usePriceBnbBusd,usePools}from'state/hooks';import{QuoteToken}from'config/constants/types';import FlexLayout from'components/layout/Flex';import Page from'components/layout/Page';import Coming from'./components/Coming';import PoolCard from'./components/PoolCard';import PoolTabButtons from'./components/PoolTabButtons';import Divider from'./components/Divider';var Farm=function Farm(){var _useRouteMatch=useRouteMatch(),path=_useRouteMatch.path;var TranslateString=useI18n();var _useWallet=useWallet(),account=_useWallet.account;var farms=useFarms();var pools=usePools(account);var bnbPriceUSD=usePriceBnbBusd();var block=useBlock();var priceToBnb=function priceToBnb(tokenName,tokenPrice,quoteToken){var tokenPriceBN=new BigNumber(tokenPrice);if(tokenName==='BNB'||tokenName==='WBNB'){return new BigNumber(1);}if(tokenPrice&&quoteToken===QuoteToken.BUSD){return tokenPriceBN.div(bnbPriceUSD);}return tokenPriceBN;};var poolsWithApy=pools.map(function(pool){var rewardTokenFarm=farms.find(function(f){return f.tokenSymbol===pool.tokenName;});var stakingTokenFarm=farms.find(function(s){return s.tokenSymbol===pool.stakingTokenName;});// /!\\ Assume that the farm quote price is BNB\nvar stakingTokenPriceInBNB=priceToBnb(QuoteToken.CAKE,stakingTokenFarm===null||stakingTokenFarm===void 0?void 0:stakingTokenFarm.tokenPriceVsQuote,stakingTokenFarm===null||stakingTokenFarm===void 0?void 0:stakingTokenFarm.quoteTokenSymbol);var rewardTokenPriceInBNB=priceToBnb(pool.tokenName,rewardTokenFarm===null||rewardTokenFarm===void 0?void 0:rewardTokenFarm.tokenPriceVsQuote,rewardTokenFarm===null||rewardTokenFarm===void 0?void 0:rewardTokenFarm.quoteTokenSymbol);// console.log('pool.tokenName', pool.tokenName)\n// console.log('rewardTokenPriceInBNB', rewardTokenPriceInBNB.toString())\n// console.log('stakingTokenPriceInBNB', stakingTokenPriceInBNB.toString())\nvar totalRewardPricePerYear=rewardTokenPriceInBNB.times(pool.tokenPerBlock).times(BLOCKS_PER_YEAR);var totalStakingTokenInPool=new BigNumber(0);totalStakingTokenInPool=stakingTokenPriceInBNB.times(getBalanceNumber(pool.totalStaked));// tokens per block * price of CAKE * blocks_per_year / ( tokens in pool x salt price) * 100\nvar apy=totalRewardPricePerYear.div(totalStakingTokenInPool).times(100);return _objectSpread(_objectSpread({},pool),{},{isFinished:pool.isFinished||block>pool.endBlock,apy:apy});});var _partition=partition(poolsWithApy,function(pool){return pool.isFinished;}),_partition2=_slicedToArray(_partition,2),finishedPools=_partition2[0],openPools=_partition2[1];return/*#__PURE__*/_jsxs(Page,{children:[/*#__PURE__*/_jsxs(Hero,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Heading,{as:\"h1\",size:\"xxl\",mb:\"16px\",children:TranslateString(282,'BNB Pool')}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:TranslateString(580,'Stake DBALL to earn new tokens.')}),/*#__PURE__*/_jsx(\"li\",{children:TranslateString(404,'You can unstake at any time.')}),/*#__PURE__*/_jsx(\"li\",{children:TranslateString(406,'Rewards are calculated per block.')})]})]}),/*#__PURE__*/_jsx(\"img\",{src:\"/images/egg/2.png\",alt:\"pool icon\",width:435,height:218})]}),/*#__PURE__*/_jsx(PoolTabButtons,{}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsxs(FlexLayout,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"\".concat(path),children:/*#__PURE__*/_jsxs(_Fragment,{children:[orderBy(openPools,['sortOrder']).map(function(pool){return/*#__PURE__*/_jsx(PoolCard,{pool:pool},pool.sousId);}),/*#__PURE__*/_jsx(Coming,{})]})}),/*#__PURE__*/_jsx(Route,{path:\"\".concat(path,\"/history\"),children:orderBy(finishedPools,['sortOrder']).map(function(pool){return/*#__PURE__*/_jsx(PoolCard,{pool:pool},pool.sousId);})})]})]});};var Hero=styled.div(_templateObject(),function(_ref){var theme=_ref.theme;return theme.colors.primary;});export default Farm;","map":{"version":3,"sources":["D:/task159/frontend/src/views/Pools/Oceans.tsx"],"names":["React","Route","useRouteMatch","BigNumber","styled","useWallet","Heading","BLOCKS_PER_YEAR","orderBy","partition","useI18n","useBlock","getBalanceNumber","useFarms","usePriceBnbBusd","usePools","QuoteToken","FlexLayout","Page","Coming","PoolCard","PoolTabButtons","Divider","Farm","path","TranslateString","account","farms","pools","bnbPriceUSD","block","priceToBnb","tokenName","tokenPrice","quoteToken","tokenPriceBN","BUSD","div","poolsWithApy","map","pool","rewardTokenFarm","find","f","tokenSymbol","stakingTokenFarm","s","stakingTokenName","stakingTokenPriceInBNB","CAKE","tokenPriceVsQuote","quoteTokenSymbol","rewardTokenPriceInBNB","totalRewardPricePerYear","times","tokenPerBlock","totalStakingTokenInPool","totalStaked","apy","isFinished","endBlock","finishedPools","openPools","sousId","Hero","theme","colors","primary"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport { Route, useRouteMatch } from 'react-router-dom'\r\nimport BigNumber from 'bignumber.js'\r\nimport styled from 'styled-components'\r\nimport { useWallet } from '@binance-chain/bsc-use-wallet'\r\nimport { Heading } from '@pancakeswap-libs/uikit'\r\nimport { BLOCKS_PER_YEAR } from 'config'\r\nimport orderBy from 'lodash/orderBy'\r\nimport partition from 'lodash/partition'\r\nimport useI18n from 'hooks/useI18n'\r\nimport useBlock from 'hooks/useBlock'\r\nimport { getBalanceNumber } from 'utils/formatBalance'\r\nimport {\r\n  useFarms,\r\n  usePriceBnbBusd,\r\n  usePools,\r\n} from 'state/hooks'\r\nimport { QuoteToken } from 'config/constants/types'\r\nimport FlexLayout from 'components/layout/Flex'\r\nimport Page from 'components/layout/Page'\r\nimport Coming from './components/Coming'\r\nimport PoolCard from './components/PoolCard'\r\nimport PoolTabButtons from './components/PoolTabButtons'\r\nimport Divider from './components/Divider'\r\n\r\nconst Farm: React.FC = () => {\r\n  const { path } = useRouteMatch()\r\n  const TranslateString = useI18n()\r\n  const { account } = useWallet()\r\n  const farms = useFarms()\r\n  const pools = usePools(account)\r\n  const bnbPriceUSD = usePriceBnbBusd()\r\n  const block = useBlock()\r\n\r\n  const priceToBnb = (tokenName: string, tokenPrice: BigNumber, quoteToken: QuoteToken): BigNumber => {\r\n    const tokenPriceBN = new BigNumber(tokenPrice)\r\n    if (tokenName === 'BNB' || tokenName === 'WBNB') {\r\n      return new BigNumber(1)\r\n    }\r\n    if (tokenPrice && quoteToken === QuoteToken.BUSD) {\r\n      return tokenPriceBN.div(bnbPriceUSD)\r\n    }\r\n    return tokenPriceBN\r\n  }\r\n\r\n  const poolsWithApy = pools.map((pool) => {\r\n    const rewardTokenFarm = farms.find((f) => f.tokenSymbol === pool.tokenName)\r\n    const stakingTokenFarm = farms.find((s) => s.tokenSymbol === pool.stakingTokenName)\r\n\r\n    // /!\\ Assume that the farm quote price is BNB\r\n    const stakingTokenPriceInBNB = priceToBnb(\r\n      QuoteToken.CAKE,\r\n      stakingTokenFarm?.tokenPriceVsQuote,\r\n      stakingTokenFarm?.quoteTokenSymbol,\r\n    )\r\n    const rewardTokenPriceInBNB = priceToBnb(\r\n      pool.tokenName,\r\n      rewardTokenFarm?.tokenPriceVsQuote,\r\n      rewardTokenFarm?.quoteTokenSymbol,\r\n    )\r\n    // console.log('pool.tokenName', pool.tokenName)\r\n    // console.log('rewardTokenPriceInBNB', rewardTokenPriceInBNB.toString())\r\n    // console.log('stakingTokenPriceInBNB', stakingTokenPriceInBNB.toString())\r\n    const totalRewardPricePerYear = rewardTokenPriceInBNB.times(pool.tokenPerBlock).times(BLOCKS_PER_YEAR)\r\n    let totalStakingTokenInPool = new BigNumber(0)\r\n    totalStakingTokenInPool = stakingTokenPriceInBNB.times(getBalanceNumber(pool.totalStaked))\r\n\r\n    // tokens per block * price of CAKE * blocks_per_year / ( tokens in pool x salt price) * 100\r\n    const apy = totalRewardPricePerYear.div(totalStakingTokenInPool).times(100)\r\n\r\n    return {\r\n      ...pool,\r\n      isFinished: pool.isFinished || block > pool.endBlock,\r\n      apy,\r\n    }\r\n  })\r\n\r\n  const [finishedPools, openPools] = partition(poolsWithApy, (pool) => pool.isFinished)\r\n\r\n  return (\r\n    <Page>\r\n      <Hero>\r\n        <div>\r\n          <Heading as=\"h1\" size=\"xxl\" mb=\"16px\">\r\n            {TranslateString(282, 'BNB Pool')}\r\n          </Heading>\r\n          <ul>\r\n            <li>{TranslateString(580, 'Stake DBALL to earn new tokens.')}</li>\r\n            <li>{TranslateString(404, 'You can unstake at any time.')}</li>\r\n            <li>{TranslateString(406, 'Rewards are calculated per block.')}</li>\r\n          </ul>\r\n        </div>\r\n        <img src=\"/images/egg/2.png\" alt=\"pool icon\" width={435} height={218} />\r\n      </Hero>\r\n      <PoolTabButtons />\r\n      <Divider />\r\n      <FlexLayout>\r\n        <Route exact path={`${path}`}>\r\n          <>\r\n            {orderBy(openPools, ['sortOrder']).map((pool) => (\r\n              <PoolCard key={pool.sousId} pool={pool} />\r\n            ))}\r\n            <Coming />\r\n          </>\r\n        </Route>\r\n        <Route path={`${path}/history`}>\r\n          {orderBy(finishedPools, ['sortOrder']).map((pool) => (\r\n            <PoolCard key={pool.sousId} pool={pool} />\r\n          ))}\r\n        </Route>\r\n      </FlexLayout>\r\n    </Page>\r\n  )\r\n}\r\n\r\nconst Hero = styled.div`\r\n  align-items: center;\r\n  color: ${({ theme }) => theme.colors.primary};\r\n  display: grid;\r\n  grid-gap: 32px;\r\n  grid-template-columns: 1fr;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  max-width: 250px;\r\n  ul {\r\n    margin: 0;\r\n    padding: 0;\r\n    list-style-type: none;\r\n    font-size: 16px;\r\n    li {\r\n      margin-bottom: 4px;\r\n    }\r\n  }\r\n  img {\r\n    height: auto;\r\n    max-width: 100%;\r\n  }\r\n  @media (min-width: 576px) {\r\n    grid-template-columns: 1fr 1fr;\r\n    margin: 0;\r\n    max-width: none;\r\n  }\r\n`\r\n\r\nexport default Farm\r\n"]},"metadata":{},"sourceType":"module"}