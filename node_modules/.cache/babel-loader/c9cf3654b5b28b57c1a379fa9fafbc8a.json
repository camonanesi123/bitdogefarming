{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect, useState } from 'react';\nimport BigNumber from 'bignumber.js';\nimport { PoolIds } from 'config/constants/types';\nimport { useERC20, useIfoV1Contract } from 'hooks/useContract';\nimport { useIfoAllowance } from 'hooks/useAllowance';\nimport makeBatchRequest from 'utils/makeBatchRequest';\nimport { getAddress } from 'utils/addressHelpers';\nimport { useWallet } from '@binance-chain/bsc-use-wallet';\n\n/**\n * Gets all data from an IFO related to a wallet\n */\nconst useGetWalletIfoData = ifo => {\n  _s();\n\n  const [state, setState] = useState({\n    [PoolIds.poolUnlimited]: {\n      amountTokenCommittedInLP: new BigNumber(0),\n      hasClaimed: false,\n      isPendingTx: false,\n      offeringAmountInToken: new BigNumber(0),\n      refundingAmountInLP: new BigNumber(0),\n      taxAmountInLP: new BigNumber(0) // Not used\n\n    }\n  });\n  const {\n    address,\n    currency\n  } = ifo;\n  const {\n    poolUnlimited\n  } = state; // const { account } = useWeb3React()\n\n  const {\n    account\n  } = useWallet();\n  const contract = useIfoV1Contract(address);\n  const currencyContract = useERC20(getAddress(currency.address));\n  const allowance = useIfoAllowance(currencyContract, address, poolUnlimited.isPendingTx);\n\n  const setPendingTx = status => setState(prevState => ({\n    [PoolIds.poolUnlimited]: { ...prevState.poolUnlimited,\n      isPendingTx: status\n    }\n  }));\n\n  const setIsClaimed = () => {\n    setState(prevState => ({\n      [PoolIds.poolUnlimited]: { ...prevState.poolUnlimited,\n        hasClaimed: true\n      }\n    }));\n  };\n\n  useEffect(() => {\n    const fetchIfoData = async () => {\n      const [offeringAmount, userInfoResponse, refundingAmount] = await makeBatchRequest([contract.methods.getOfferingAmount(account).call, contract.methods.userInfo(account).call, contract.methods.getRefundingAmount(account).call]);\n      setState(prevState => ({\n        [PoolIds.poolUnlimited]: { ...prevState.poolUnlimited,\n          amountTokenCommittedInLP: new BigNumber(userInfoResponse.amount),\n          hasClaimed: userInfoResponse.claimed,\n          offeringAmountInToken: new BigNumber(offeringAmount),\n          refundingAmountInLP: new BigNumber(refundingAmount)\n        }\n      }));\n    };\n\n    if (account) {\n      fetchIfoData();\n    }\n  }, [account, contract, setState]);\n  return { ...state,\n    allowance,\n    contract,\n    setPendingTx,\n    addUserContributedAmount: () => null,\n    setIsClaimed\n  };\n};\n\n_s(useGetWalletIfoData, \"QUX3a20FlWC8zAhHazFgIodpjl8=\", false, function () {\n  return [useWallet, useIfoV1Contract, useERC20, useIfoAllowance];\n});\n\nexport default useGetWalletIfoData;","map":{"version":3,"sources":["C:/Users/hexia/Desktop/pancake_fork/frontend/src/hooks/ifo/v1/useGetWalletIfoData.ts"],"names":["useEffect","useState","BigNumber","PoolIds","useERC20","useIfoV1Contract","useIfoAllowance","makeBatchRequest","getAddress","useWallet","useGetWalletIfoData","ifo","state","setState","poolUnlimited","amountTokenCommittedInLP","hasClaimed","isPendingTx","offeringAmountInToken","refundingAmountInLP","taxAmountInLP","address","currency","account","contract","currencyContract","allowance","setPendingTx","status","prevState","setIsClaimed","fetchIfoData","offeringAmount","userInfoResponse","refundingAmount","methods","getOfferingAmount","call","userInfo","getRefundingAmount","amount","claimed","addUserContributedAmount"],"mappings":";;AAAA,SAASA,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AAEA,OAAOC,SAAP,MAAsB,cAAtB;AACA,SAAcC,OAAd,QAA6B,wBAA7B;AACA,SAASC,QAAT,EAAmBC,gBAAnB,QAA2C,mBAA3C;AACA,SAASC,eAAT,QAAgC,oBAAhC;AACA,OAAOC,gBAAP,MAA6B,wBAA7B;AACA,SAASC,UAAT,QAA2B,sBAA3B;AACA,SAASC,SAAT,QAA0B,+BAA1B;;AASA;AACA;AACA;AACA,MAAMC,mBAAmB,GAAIC,GAAD,IAA6B;AAAA;;AACvD,QAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBZ,QAAQ,CAAiB;AACjD,KAACE,OAAO,CAACW,aAAT,GAAyB;AACvBC,MAAAA,wBAAwB,EAAE,IAAIb,SAAJ,CAAc,CAAd,CADH;AAEvBc,MAAAA,UAAU,EAAE,KAFW;AAGvBC,MAAAA,WAAW,EAAE,KAHU;AAIvBC,MAAAA,qBAAqB,EAAE,IAAIhB,SAAJ,CAAc,CAAd,CAJA;AAKvBiB,MAAAA,mBAAmB,EAAE,IAAIjB,SAAJ,CAAc,CAAd,CALE;AAMvBkB,MAAAA,aAAa,EAAE,IAAIlB,SAAJ,CAAc,CAAd,CANQ,CAMU;;AANV;AADwB,GAAjB,CAAlC;AAWA,QAAM;AAAEmB,IAAAA,OAAF;AAAWC,IAAAA;AAAX,MAAwBX,GAA9B;AACA,QAAM;AAAEG,IAAAA;AAAF,MAAoBF,KAA1B,CAbuD,CAevD;;AACA,QAAM;AAAEW,IAAAA;AAAF,MAAcd,SAAS,EAA7B;AACA,QAAMe,QAAQ,GAAGnB,gBAAgB,CAACgB,OAAD,CAAjC;AACA,QAAMI,gBAAgB,GAAGrB,QAAQ,CAACI,UAAU,CAACc,QAAQ,CAACD,OAAV,CAAX,CAAjC;AACA,QAAMK,SAAS,GAAGpB,eAAe,CAACmB,gBAAD,EAAmBJ,OAAnB,EAA4BP,aAAa,CAACG,WAA1C,CAAjC;;AAEA,QAAMU,YAAY,GAAIC,MAAD,IACnBf,QAAQ,CAAEgB,SAAD,KAAgB;AACvB,KAAC1B,OAAO,CAACW,aAAT,GAAyB,EACvB,GAAGe,SAAS,CAACf,aADU;AAEvBG,MAAAA,WAAW,EAAEW;AAFU;AADF,GAAhB,CAAD,CADV;;AAQA,QAAME,YAAY,GAAG,MAAM;AACzBjB,IAAAA,QAAQ,CAAEgB,SAAD,KAAgB;AACvB,OAAC1B,OAAO,CAACW,aAAT,GAAyB,EACvB,GAAGe,SAAS,CAACf,aADU;AAEvBE,QAAAA,UAAU,EAAE;AAFW;AADF,KAAhB,CAAD,CAAR;AAMD,GAPD;;AASAhB,EAAAA,SAAS,CAAC,MAAM;AACd,UAAM+B,YAAY,GAAG,YAAY;AAC/B,YAAM,CAACC,cAAD,EAAiBC,gBAAjB,EAAmCC,eAAnC,IAAuD,MAAM3B,gBAAgB,CAAC,CAClFiB,QAAQ,CAACW,OAAT,CAAiBC,iBAAjB,CAAmCb,OAAnC,EAA4Cc,IADsC,EAElFb,QAAQ,CAACW,OAAT,CAAiBG,QAAjB,CAA0Bf,OAA1B,EAAmCc,IAF+C,EAGlFb,QAAQ,CAACW,OAAT,CAAiBI,kBAAjB,CAAoChB,OAApC,EAA6Cc,IAHqC,CAAD,CAAnF;AAMAxB,MAAAA,QAAQ,CAAEgB,SAAD,KAAgB;AACvB,SAAC1B,OAAO,CAACW,aAAT,GAAyB,EACvB,GAAGe,SAAS,CAACf,aADU;AAEvBC,UAAAA,wBAAwB,EAAE,IAAIb,SAAJ,CAAc+B,gBAAgB,CAACO,MAA/B,CAFH;AAGvBxB,UAAAA,UAAU,EAAEiB,gBAAgB,CAACQ,OAHN;AAIvBvB,UAAAA,qBAAqB,EAAE,IAAIhB,SAAJ,CAAc8B,cAAd,CAJA;AAKvBb,UAAAA,mBAAmB,EAAE,IAAIjB,SAAJ,CAAcgC,eAAd;AALE;AADF,OAAhB,CAAD,CAAR;AASD,KAhBD;;AAkBA,QAAIX,OAAJ,EAAa;AACXQ,MAAAA,YAAY;AACb;AACF,GAtBQ,EAsBN,CAACR,OAAD,EAAUC,QAAV,EAAoBX,QAApB,CAtBM,CAAT;AAwBA,SAAO,EAAE,GAAGD,KAAL;AAAYc,IAAAA,SAAZ;AAAuBF,IAAAA,QAAvB;AAAiCG,IAAAA,YAAjC;AAA+Ce,IAAAA,wBAAwB,EAAE,MAAM,IAA/E;AAAqFZ,IAAAA;AAArF,GAAP;AACD,CA/DD;;GAAMpB,mB;UAgBgBD,S,EACHJ,gB,EACQD,Q,EACPE,e;;;AA8CpB,eAAeI,mBAAf","sourcesContent":["import { useEffect, useState } from 'react'\nimport { useWeb3React } from '@web3-react/core'\nimport BigNumber from 'bignumber.js'\nimport { Ifo, PoolIds } from 'config/constants/types'\nimport { useERC20, useIfoV1Contract } from 'hooks/useContract'\nimport { useIfoAllowance } from 'hooks/useAllowance'\nimport makeBatchRequest from 'utils/makeBatchRequest'\nimport { getAddress } from 'utils/addressHelpers'\nimport { useWallet } from '@binance-chain/bsc-use-wallet'\nimport { WalletIfoState, WalletIfoData } from '../types'\n\n\ninterface UserInfo {\n  amount: BigNumber\n  claimed: boolean\n}\n\n/**\n * Gets all data from an IFO related to a wallet\n */\nconst useGetWalletIfoData = (ifo: Ifo): WalletIfoData => {\n  const [state, setState] = useState<WalletIfoState>({\n    [PoolIds.poolUnlimited]: {\n      amountTokenCommittedInLP: new BigNumber(0),\n      hasClaimed: false,\n      isPendingTx: false,\n      offeringAmountInToken: new BigNumber(0),\n      refundingAmountInLP: new BigNumber(0),\n      taxAmountInLP: new BigNumber(0), // Not used\n    },\n  })\n\n  const { address, currency } = ifo\n  const { poolUnlimited } = state\n\n  // const { account } = useWeb3React()\n  const { account } = useWallet()\n  const contract = useIfoV1Contract(address)\n  const currencyContract = useERC20(getAddress(currency.address))\n  const allowance = useIfoAllowance(currencyContract, address, poolUnlimited.isPendingTx)\n\n  const setPendingTx = (status: boolean) =>\n    setState((prevState) => ({\n      [PoolIds.poolUnlimited]: {\n        ...prevState.poolUnlimited,\n        isPendingTx: status,\n      },\n    }))\n\n  const setIsClaimed = () => {\n    setState((prevState) => ({\n      [PoolIds.poolUnlimited]: {\n        ...prevState.poolUnlimited,\n        hasClaimed: true,\n      },\n    }))\n  }\n\n  useEffect(() => {\n    const fetchIfoData = async () => {\n      const [offeringAmount, userInfoResponse, refundingAmount] = (await makeBatchRequest([\n        contract.methods.getOfferingAmount(account).call,\n        contract.methods.userInfo(account).call,\n        contract.methods.getRefundingAmount(account).call,\n      ])) as [string, UserInfo, string]\n\n      setState((prevState) => ({\n        [PoolIds.poolUnlimited]: {\n          ...prevState.poolUnlimited,\n          amountTokenCommittedInLP: new BigNumber(userInfoResponse.amount),\n          hasClaimed: userInfoResponse.claimed,\n          offeringAmountInToken: new BigNumber(offeringAmount),\n          refundingAmountInLP: new BigNumber(refundingAmount),\n        },\n      }))\n    }\n\n    if (account) {\n      fetchIfoData()\n    }\n  }, [account, contract, setState])\n\n  return { ...state, allowance, contract, setPendingTx, addUserContributedAmount: () => null, setIsClaimed }\n}\n\nexport default useGetWalletIfoData\n"]},"metadata":{},"sourceType":"module"}